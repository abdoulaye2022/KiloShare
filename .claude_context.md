# 📁 Structure Complète du Projet KiloShare

## 🏗️ Architecture Générale
```
kiloshare/
├── 📱 mobile/          # Application Flutter (iOS/Android)
├── 🌐 web/            # Interface Web Next.js avec panel admin
├── ⚙️ backend/        # API REST PHP avec architecture MVC
└── 🗄️ database/       # Scripts SQL et schémas de base de données
```

---

## 📱 **Mobile (Flutter)**
```
mobile/
├── android/                    # Configuration Android
├── ios/                       # Configuration iOS
├── lib/
│   ├── config/               # Configuration app (environnements, thèmes)
│   │   ├── app_config.dart
│   │   └── theme.dart
│   ├── modules/              # Modules métier
│   │   ├── auth/            # Authentification
│   │   │   ├── blocs/       # BLoC pattern pour gestion d'état
│   │   │   ├── models/      # Modèles de données
│   │   │   ├── screens/     # Écrans UI
│   │   │   └── services/    # Services API
│   │   ├── booking/         # Système de réservation
│   │   │   ├── models/
│   │   │   ├── screens/
│   │   │   └── services/
│   │   ├── home/            # Écran d'accueil
│   │   ├── profile/         # Profil utilisateur
│   │   │   ├── models/      # UserProfile, TrustBadge, etc.
│   │   │   ├── screens/     # edit_profile, profile, settings
│   │   │   ├── services/    # profile_service.dart
│   │   │   └── widgets/     # Composants réutilisables
│   │   ├── search/          # Recherche de trajets
│   │   └── trips/           # Gestion des trajets
│   │       ├── bloc/        # trip_bloc.dart
│   │       ├── models/      # Trip, TripImage, etc.
│   │       ├── screens/     # search_trips, trip_details
│   │       ├── services/    # trip_service, favorites_service
│   │       └── widgets/     # trip_card, price_calculator
│   ├── services/            # Services globaux
│   │   ├── cloudinary_image_service.dart
│   │   └── stripe_service.dart
│   ├── themes/              # Thèmes et styles
│   ├── utils/               # Utilitaires
│   ├── widgets/             # Widgets réutilisables
│   │   └── optimized_cloudinary_image.dart  # CloudinaryAvatar
│   └── main.dart            # Point d'entrée
├── pubspec.yaml            # Dépendances Flutter
└── test/                   # Tests unitaires
```

---

## 🌐 **Web (Next.js)**
```
web/
├── app/
│   ├── admin/              # Panel d'administration
│   │   ├── dashboard/      # Tableau de bord admin
│   │   ├── users/         # Gestion utilisateurs
│   │   ├── trips/         # Gestion trajets
│   │   ├── messages/      # Messages
│   │   ├── reports/       # Rapports
│   │   ├── transactions/  # Transactions
│   │   ├── settings/      # Paramètres
│   │   └── layout.tsx     # Layout admin
│   ├── api/               # API Routes Next.js
│   │   ├── admin/         # Endpoints admin
│   │   └── user/          # Endpoints utilisateur
│   ├── trips/             # Pages publiques trajets
│   ├── layout.tsx         # Layout principal
│   └── page.tsx           # Page d'accueil
├── components/            # Composants React
│   ├── admin/            # Composants admin
│   │   ├── AdminAuthProvider.tsx
│   │   ├── AdminHeader.tsx
│   │   └── AdminSidebar.tsx
│   ├── MobileBottomNav.tsx
│   ├── Navigation.tsx
│   ├── TripWorkflowActions.tsx
│   └── TripWorkflowHistory.tsx
├── hooks/                # Hooks React personnalisés
│   ├── useAdminAuth.ts
│   └── useTripWorkflow.ts
├── utils/                # Utilitaires
├── package.json          # Dépendances Node.js
└── next.config.js        # Configuration Next.js
```

---

## ⚙️ **Backend (PHP)**
```
backend/
├── public/
│   └── index.php          # Point d'entrée API
├── src/
│   ├── Controllers/       # Contrôleurs MVC
│   │   ├── AuthController.php
│   │   ├── UserProfileController.php
│   │   ├── TripController.php
│   │   ├── BookingController.php
│   │   ├── SearchController.php
│   │   ├── MessageController.php
│   │   ├── NotificationController.php
│   │   └── AdminController.php
│   ├── Models/            # Modèles Eloquent ORM
│   │   ├── User.php
│   │   ├── Trip.php
│   │   ├── TripFavorite.php
│   │   ├── TripImage.php
│   │   ├── Booking.php
│   │   ├── Message.php
│   │   ├── Notification.php
│   │   ├── Payment.php
│   │   └── UserToken.php
│   ├── Middleware/        # Middlewares HTTP
│   │   ├── AuthMiddleware.php
│   │   └── CorsMiddleware.php
│   ├── Services/          # Services métier (vide - logique dans contrôleurs)
│   └── Utils/             # Utilitaires
├── config/               # Configuration
│   ├── config.php        # Configuration générale
│   ├── database.php      # Configuration BDD
│   └── routes.php        # Définition des routes
├── migrations/           # Scripts de migration BDD
│   ├── add_missing_columns.sql
│   └── add_missing_columns_v2.sql
├── storage/             # Stockage fichiers
│   ├── logs/
│   └── uploads/
├── composer.json        # Dépendances PHP
├── .env.example         # Variables d'environnement
└── README.md
```

---

## 🗄️ **Database**
```
database/
├── schema.sql                    # Schéma complet de la BDD
├── auth_tables.sql              # Tables d'authentification
├── social_auth_tables.sql       # Authentification sociale
├── email_verification_table.sql # Vérification email
├── phone_verification_table.sql # Vérification téléphone
└── password_resets_table.sql    # Reset de mot de passe
```

---

## 📋 **Fichiers de Configuration Racine**
```
kiloshare/
├── .claude_project.json         # Configuration Claude Code
├── .claude_context.md          # Ce fichier - documentation structure
├── WORKFLOW_TESTING.md         # Documentation des tests
└── .git/                       # Contrôle de version Git
```

---

## 🔧 **Technologies Utilisées**

### Mobile (Flutter)
- **Language**: Dart
- **Framework**: Flutter 3.x
- **Architecture**: BLoC Pattern
- **State Management**: flutter_bloc
- **HTTP**: Dio
- **Navigation**: GoRouter
- **Storage**: flutter_secure_storage
- **Images**: cached_network_image, CloudinaryAvatar
- **UI**: Material Design 3

### Web (Next.js)
- **Language**: TypeScript
- **Framework**: Next.js 14+ (App Router)
- **UI**: React 18, Tailwind CSS
- **State**: React Hooks, Context API
- **Auth**: JWT avec refresh tokens
- **API**: Next.js API Routes

### Backend (PHP)
- **Language**: PHP 8+
- **Framework**: Vanilla PHP avec architecture MVC
- **ORM**: Eloquent (Laravel components)
- **Database**: MySQL
- **Auth**: JWT avec Firebase
- **Images**: Cloudinary SDK
- **HTTP**: PSR-7 compliant
- **Routing**: FastRoute

### Database
- **SGBD**: MySQL 8.0+
- **ORM**: Eloquent
- **Migrations**: Scripts SQL manuels
- **Indexation**: Optimisée pour les recherches

---

## 🚀 **Fonctionnalités Principales**

### 📱 **Application Mobile**
- ✅ Authentification complète (phone, email, social)
- ✅ Profil utilisateur avec avatar Cloudinary
- ✅ Recherche et réservation de trajets
- ✅ Système de favoris
- ✅ Chat en temps réel
- ✅ Paiements Stripe
- ✅ Notifications push

### 🌐 **Interface Web**
- ✅ Panel d'administration complet
- ✅ Gestion utilisateurs et trajets
- ✅ Système de workflow d'approbation
- ✅ Statistiques et rapports
- ✅ Interface publique de recherche

### ⚙️ **API Backend**
- ✅ API REST complète
- ✅ Authentification JWT
- ✅ Upload d'images Cloudinary
- ✅ Système de favoris
- ✅ Gestion des réservations
- ✅ Administration complète

---

## 📊 **État Actuel du Projet**

### ✅ **Fonctionnalités Complètes**
- Système d'authentification multi-canal
- Profil utilisateur avec tous les champs
- Affichage des avatars Cloudinary optimisé
- Système de favoris fonctionnel
- Panel d'administration web
- API REST complète

### 🔄 **En Cours de Développement**
- Tests automatisés
- Optimisations performances
- Documentation API

### 📈 **Métriques**
- **Mobile**: ~100 fichiers Dart
- **Web**: ~50 fichiers TypeScript/TSX  
- **Backend**: ~25 fichiers PHP
- **Database**: 15+ tables avec relations

---

## 🎯 **Workflow Git & Développement**

### Branches
- **master**: Production
- **claude/[feature]-[date]**: Branches de travail Claude
- Toujours créer une nouvelle branche pour chaque feature

### Règles de Développement
1. Ne jamais commiter directement sur master
2. Toujours travailler sur une branche claude/*
3. Commiter régulièrement avec des messages descriptifs
4. Créer des petits commits atomiques
5. Documenter chaque nouvelle fonctionnalité

## 🚫 **Instructions importantes pour Claude Code**

### **NE PAS lancer de serveurs**
- ❌ Ne jamais exécuter `npm run dev`
- ❌ Ne jamais exécuter `flutter run` 
- ❌ Ne jamais exécuter `php -S 127.0.0.1:8080 -t public`
- ❌ Aucune commande de démarrage de serveur

**Raison** : L'environnement de développement est géré séparément.

### **Actions autorisées uniquement**
- ✅ Modifier le code
- ✅ Créer/éditer des fichiers
- ✅ Installer des dépendances (`composer install`, `npm install`)
- ✅ Exécuter des migrations/scripts SQL
- ✅ Générer du code

Cette structure reflète une architecture moderne multi-plateforme avec séparation claire des responsabilités et technologies adaptées à chaque contexte d'usage.